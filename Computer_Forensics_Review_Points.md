## 计算机取证复习要点	

一段话记一下（说是结合时政。，。必考）：



### Chapter 1 ：取证与司法鉴定概论

#### 1. 取证与司法鉴定概念/def：

1. 将计算机调查和分析技术应用于对潜在的、有法律效力的证据的确定与获取
2. 对计算机证据的保护、确认、提取、归档的过程
3. 从计算机中收集、发现证据
4. 运用计算机科学理论和技术，以及其他相关专门知识和经验对涉及诉讼的电子数据进行判断、鉴定（p26）

#### 2. 电子数字取证 vs 电子取证 vs 计算机取证与司法鉴定

1. 电子数字取证主体对象：存在于各种电子设备、计算机系统内与案件有关的数据信息
2. 电子取证主体对象：电子化存储的、能反应有关案件真实情况的数据信息
3. 取证与司法鉴定主体对象：计算机系统内与案件有关的数据信息

#### 3. 计算机取证的层次功能：

<img src="/Users/rgmax/Desktop/取证上分/1.jpg" alt="1" style="zoom:50%;" />

#### 4. 反取证技术

def：反取证技术就是删除或隐藏证据使调查失效

分类：

+ 数据擦除
+ 数据隐藏
+ 数据加密

典型工具： Runefs

#### 5.  主动取证技术（p5、23）

def：通过诱骗或攻击性手段获取犯罪证据

1. 典型技术---**蜜罐**（HoneyPot）技术--分类：
   + 产品型：用来降低网络安全风险，提供入侵监测能力
+ 研究型：用来记录和研究入侵着的活动步骤、工具、方法
2. **边界进入技术以及信息获取**技术（SQL注入、缓冲区溢出、自动脚本执行、弱配置和弱密码发现）
3. **动态监听与日志保全**技术（入侵取证系统，亦称“黑匣子”）
4. **密码分析与破解**技术

#### 6. G8小组提出的关于取证与司法鉴定的6条原则

1. 必须用标准的取证与司法鉴定过程（用标准）
2. 获取证据时所采取的任何方式都不能改变原始证据（不更改）
3. 取证与司法鉴定人员必须经过专门培训（必培训）
4. 完整第记录证据的获取、访问、存储或传输的过程，并妥善保存（完整性）
5. 电子证据保管人员必须对在该证据上的任何行为负责（须负责）
6. 任何负责获取、访问、存储、传输电子证据的机构有责任遵循以上原则（循原则）

#### 7. 计算机取证的4条基本原则（通用的取证与司法鉴定原则）

1. 依法取证
2. 无损取证
3. 全面取证
4. 及时取证（有些数据证据具有时效性）

【依法、无损、全面、及时】

#### 8. 依法取证4要素（要保证取证与司法鉴定的四要素同时合法才能保证证据合法）

1. 主体合法（证据的提交者：合法的调查人员+合法的取证鉴定技术专家）
2. 对象合法（受攻击/被入侵的电子设备或计算机系统）
3. 手段合法（物理取证「手工直接取证」+ 工具取证「通过特制工具取证」）
4. 过程合法（遵循取证与司法鉴定的规范 + 2个合法取证人员取证 + 完整性保护）

#### 9. 计算机取证与司法鉴定技术主要分为两类：

+ **主机与其他电子设备**取证
+ **网络**取证

因此，分析取证与司法鉴定的模型也可以从这两类进行

#### 10. （国外）取证与司法鉴定的过程模型【按上一点分两类】

+ **主机与其他电子设备**取证与分析鉴定系统模型【5种典型的取证过程模型】
  1. **基本**过程模型（领航和奠基作用；取证过程粒度粗，没有把事件发生前的取证准备作为取证的阶段）
  2. **事件响应**过程模型（“攻击预防阶段”概念的提出，成为专业取证方法区别于非专业的关键步骤）
  3. **法律执行**过程模型（美国司法部-DOJ提出，侧重于物理犯罪取证（非数字取证），对系统分析涉及少）
  4. **过程抽象**模型（里程碑作用，分两类）：
     + AIRFORCE过程抽象模型（美国空军提出，抽象出通用取证过程共性，真正扩展到数字取证，进一步奠定基础、迈上新台阶）
     + DOJ过程抽象模型（美国司法部DOJ提出，又一次发展，真正触及了数字取证的核心）
  5. **其他**过程模型（第一个大规模的研究数字取证理论的联盟组织——数字取证研究组Digital Forensics Research Workshop，DFRW，规范取证理论）

+ **网络**取证与分析系统模型

  + 网络取证主要对 **网络流量、审计迹、主机系统日志** 等实时监控和分析，目前研究更强调 **对网络的动态信息收集** 和 **网络安全的主动防御**

  + 基于模糊专家系统的网络取证系统 流程图：

    <img src="/Users/rgmax/Desktop/取证上分/2.jpg" alt="2" style="zoom:50%;" />

    + 6个部分组成：网络流分析器、知识库、模糊化、模糊推理引擎、反模糊化、取证分析器

#### 11. 取证与司法鉴定过程模型（通用模型，考试应该考这个不考上面的）

<img src="/Users/rgmax/Desktop/取证上分/3.jpg" alt="3" style="zoom:50%;" />



#### 12. 取证与司法鉴定中的分析鉴定作为核心环节通常需要实施以下方案：

<img src="/Users/rgmax/Desktop/取证上分/4.jpg" alt="4" style="zoom:50%;" />

#### 13. 取证与司法鉴定 计划的制定

1. **空间**分析
   + 由于网络的特点导致证据的分布性（分散性，不仅在PC上，还在网络流量中），要将涉案的证据进行融合推理分析，推理分析的基础理论是：Locard交换原理，即 当任两个物体相互接触时，就会产生交叉转移（核心原则就是，实施犯罪必有蛛丝马迹。，。感觉是p话）
2. **功能**分析
   + 理解证据的作用、了解作案意图动机，评估数字证据的可靠性和含义
3. **时间**分析
   + 确定某一时段事态的证据，识别时间的顺序和事件的即时性（创建、修改、最后一次访问时间——时间戳）
4. **结构**分析和**粒度**分析
   + 结构和粒度越大，分析越简单，反之则越需要技术和设备
5. **数据**分析和**代码**分析
   + 扫描文件类型，对比各类文件特征，注意隐藏和改变属性存储的文件、系统日志、注册表、上网记录、删除的数据、文件碎片

#### 14. 取证和司法鉴定的 工作环境和证据链监督

+ 工作环境：远离磁场、高温、灰尘、积压、潮湿、腐蚀性化学试剂，防窃、防病毒、防消磁，用正版合法取证软件和存储软件
+ 证据链监督：
  + 证据的移交、保管、开封、拆卸 必须由 司法人员+保管人员 共同完成
  + 真实性、完整性
  + 校验技术 用于 证据链 监督、认证
  + 时间戳技术 用于 对电子数据登记 并 提供注册后的时间信息

#### 15. 计算机取证的 操作程序规则 （6条）

1. **受理**案件
2. **保护**涉案**现场** （首要之事——冻结现场计算机系统，保护当前状态）
3. **收集**电子证据
4. **固定与保管**电子证据
5. **分析**电子证据
6. **归档**电子证据

#### 16. 计算机证据的 显示与质证

+ 证据显示（展示、再现、先悉）：**庭审调查前**在**双方当事人**之间**获取涉案信息**、证据交换
+ 质证：在**庭审过程中**由案件**当事人**就法庭上所出示的证据采取辨认、质疑、说明、辩论等心事进行**对质核**实，以**确认证据的证明力**

### Chapter 2: 取证与司法鉴定的相关法学问题（这一章没有在老师的提纲里，应该不做重点）

#### 1. 取证与司法鉴定 的主要任务：

+ 通过对数据、软件、程序功能以及对电子证据进行的 提取、检查、分析、鉴定，以此对电子证据的真伪、因果、种属、完整性给出鉴定意见

#### 2. 取证与司法鉴定 的主要内容：

+ **来源**取证（确定数据来源，IP、MAC、email...）
+ **同一**取证（确定两份电子文档是否一致）
+ **内容**取证（文档内容真实性、隐藏数据、加密数据...）
+ **功能**取证（软件功能、特征）
+ **损失**取证（涉案资产损失评估，有形资产、无形资产）
+ **复合**取证（其他的特殊取证，软件知识产权取证、计算机会计取证...）

#### 3. 取证与司法鉴定 的3大技术基础

+ **只读**技术
+ **克隆**技术
+ **校验**技术

#### 4. 取证与司法鉴定 相关事项

1. 认定信息的 存在性
2. 认定信息的 量
3. 认定信息的 同一性和相似性
4. 认定信息的 来源
5. 认定程序的 功能
6. 认定程序的 同一性和相似性
7. 重构事件

#### 5. 司法鉴定的 8大原则

1. 合法
2. 科学
3. 客观
4. 独立
5. 监督
6. 保密
7. 时限
8. 公平、公正、公开

#### 6. 司法鉴定的 方法

1. 同一认定
2. 种属认定
3. 因果认定

#### 7. 司法鉴定的 程序

1. 司法鉴定的 **申请**
2. 司法鉴定的 **决定**
3. 司法鉴定的 **委托**
4. 司法鉴定的 **实施**
5. 鉴定意见的 **出具**
6. 鉴定人**出庭**
7. 鉴定意见的 **质证**
8. 鉴定意见的 **认证**

### Chapter 3: 取证与司法鉴定 基础知识

#### 1. 仪器设备 配置原则

1. **预检工作**（拍照、录像、通电测试，记录检材受理前的各种真实状态和电器属性）
2. **检材接受**（正式受理后对检材 进行 Hash校验 并 封存Hash值）
3. **检材克隆**（位对位克隆、Hash值比对，确保副本和原检材的一致性）
4. **数据分析**（多形式、多手段、多层次粒度 分析数据）
5. **提取固定、鉴定结论、出庭质询**（提取并固定有价值证据，形成鉴定结论，做好出庭质询的准备）
6. **工作环境、证据链监督、仪器设备的评测准入**（是计算机取证与司法鉴定过程控制与质量管理的 具体体现）

#### 2. 取证的 8类 必备设备

1. 照相机+摄像机
2. 只读接口
3. 数据克隆工具
4. 校验码计算工具
5. 电子数据校验专用计算机
6. 综合性电子数据恢复、搜索、分析软件
7. 电子物证存储柜
8. 其他必要工具（转接口、数据线等）

#### 3. 取证的 选配设备（按照取证与司法鉴定的类别层次 分 3 类）

1. 技术支撑设备
   + 密码破解系统
   + 专业数据恢复工具
   + 磁盘阵列重组设备
   + 海量数据存储系统
2. 应用支撑设备
   + 即时通信 综合取证分析工具
   + 病毒及恶意代码 综合分析工具
   + 电子文档与数据电文 综合分析工具
   + 数据比较工具
   + 现场取证工具
   + 在线取证工具
   + 手机数据提取、恢复、分析工具
   + Mac/Linux系统检验工具
3. 其他工具设备
   + 数据销毁设备
   + 存储介质修复工具
   + 工业超净间
   + 电焊台
   + 磁力显微镜
   + 录音笔
   + 扫描仪
   + 路由器
   + ...

<img src="/Users/rgmax/Desktop/取证上分/5.jpg" alt="5" style="zoom:50%;" />

#### 4. 取证 准备阶段 的 4个 主要工作

1. 明确案例调查对象（企业高管、企业组织律师、企业HR、企业技术部门）
2. 尽早明确取证目标（硬件和其他证据（各种电子设备）、计算机设备内的所有数据（内存、磁盘）、计算机设备内的所需数据（email）、网络中的数据）
3. 根据实际情况 准备 取证工具及设备 （取证的各种 软件、硬件）
4. 审查响应计划中取证需遵循的程序和步骤，依据实际情况做调整

#### 5. 计算机证据的保全主要是解决 证据的完整性

+ 因为计算机证据易修改、易损毁，估必须确保完整性
+ 时间戳也是重要技术，证明证据的时间信息和在此时间内不曾修改

#### 6. 计算机证据分析的 主要内容（6步）【证据分析是取证的核心和关键】

1. 分析硬盘的分区表
2. 浏览文件系统的目录树并打印
3. 关键词搜索
4. 用数据恢复工具找回删除文件
5. 用专门工具 检查文件系统中 未分配空间 和 闲散空间 以寻找 残留数据
6. 备份证据，制作可读性文件

### Chapter 4: Windows系统取证与分析

#### 1. Win 现场取证的 固定证据 有哪些（3个）【感觉老师这说法不对。，。应该是 需要固定的证据有哪些】

1. 固定硬盘（位对位克隆硬盘，ENCASE工具）
2. 部分文件的固定
3. 固定易丢失的证据

#### 2. Win 现场取证 固定易丢失证据 有哪些（6个）【应该是 需要固定的 易丢失的证据 有哪些】

1. 系统时间和日期
2. 最近运行的进程列表
3. 最近打开的套接字列表
4. 打开的套接字上进行监听的应用程序
5. 当前登陆的用户列表
6. 当前/最近与系统建立连接的系统列表

#### 3. Win 现场取证，现场数据收集的基本过程（4点）

1. 打开一个可信的命令解释程序
2. 数据收集系统的准备（不能将数据写回被入侵机器的硬盘，要写到取证用的移动硬盘）
3. 收集易失性证据（用各种初始响应工具收集，cmd、pslist、fport、netcat、netstat）
4. 编写初始响应脚本（自动化运行各种初始响应工具）

补充，各种初始响应工具作用：

<img src="/Users/rgmax/Desktop/取证上分/6.jpg" alt="6" style="zoom:50%;" />

<img src="/Users/rgmax/Desktop/取证上分/7.jpg" alt="7" style="zoom:50%;" />

#### 4. Win 两个关键的证据来源

1. 事件日志
2. 注册表

#### 5. Win 深入获取证据的 途径 （4点）

1. 事件日志（Win日志文件：系统日志、安全日志、应用程序日志）【工具：ntlast、Win事件查看器】
2. 注册表（存储了大量在初始响应期间的重要数据）【reg、regdump】
3. 系统密码（SAM文件是Win NT的用户账户数据库，所有NT用户的登录名和口令等相关信息都存放在此，口令会被加密）【pwddump、findpass、LC5】
4. 转储系统RAM（保存内存数据）【dumpit】

#### 6. Win 电子证据的获取（7大块）

1. 日志
   + 系统日志（Win系统维护3个相互独立的日志文件：系统日志、安全日志、应用程序日志）
   + 服务程序日志（Windows Internet Information Services - IIS服务）
   + 防火墙、入侵检测系统日志（分析数据报：端口、协议等）
2. 文件和目录
   + 启动目录（把想要自启动的程序 的 文件or快捷方式 放在启动目录文件夹里就好了）
     + C:\documents and settings\用户名\开始菜单\程序\启动
     + C:\documents and settings\all users\开始菜单\程序\启动
   + 系统目录（存放操作系统主要文件，直接影响系统能否正常工作）
   + 我的文档
   + 最近打开的文档
   + 删除文件的恢复
3. 注册表
   + 启动项（检查工具AutoRuns）
   + 用户信息项（用户名、用户所属组织、产品ID等）
   + 系统信息项（注册表查询工具reg，自带的）
4. 进程列表
   + 系统进程（包括 基本系统进程（必备，一般无法强制结束） 、附加进程（非必需））
   + 用户进程（一般书用户安装的 应用程序进程）
   + 开始运行处进程（启动时自运行的进程）【用自带的 services.msc 查看服务进程】
   + 进程分析（进程 操作文件、注册表、访问网络的情况）【工具 pslist、fport、netstat】
5. 网络轨迹
   + 网站访问下拉列表
   + 网站访问的历史记录
   + 网站收藏夹
6. 系统服务
   + 计划任务服务（工具 at命令 可创建、安排、查看计划任务）
   + 共享服务（网络共享文件夹）
   + 远程控制和远程访问服务（常用远程控制软件：PCAnywhere、Radmin、TerminalService）
7. 用户分析
   + 用户列表（系统中有哪些用户，默认的两个账户：Administrator、Guest）
   + 用户属性（属于哪个组，权限如何）
   + 用户相关的文档（所有权等）

#### 7. 常用Win 取证工具

1. EnCase（广泛使用的 取证与司法鉴定工具）
2. MD5sums（MD5校验值计算工具）
3. pslist（进程工具）
4. AutoRuns（注册表工具）
5. fport（网络查看工具，查看系统进程与端口关联）
6. netstat（网络查看工具，各种网络连接信息）
7. psservice（服务管理工具）

#### 8. 现场取证和脱机取证（p113 小结里）

+ 现场取证：除了取硬盘、文件目录，更多的是取 易失性数据，此外还需取 注册表、日志、系统密码等数据
+ 脱机取证：对现场取证时取下的硬盘进行进一步取证，一般对 注册表、进程、服务、文件和目录、日志文件、网络轨迹等进行取证，形成文件，并固定

### Chapter 5: Unix/Linux 取证与分析

#### 0. Unix/Linux 系统概要

+ Unix/Linux系统主要由3部分组成：内核（Kernel）、Shell、文件系统
+ Unix/Linux 文件目录及功能：

<img src="/Users/rgmax/Desktop/取证上分/8.jpg" alt="8" style="zoom:50%;" />

#### 1. Unix/Linux 现场证据获取（Linux的现场证据有哪些？4点）

1. **屏幕信息**

   + 控制台下：setterm -dump 控制台编号；如果只想获取文字信息，直接用管道重定向保存就好
   + X-Windows下：xwd、xwud截图工具，ScreenShooter、Ksnapshot等截图工具

2. **内存及硬盘信息**

   + 查看硬盘分区：fdisk -l 、more /proc/partitions

   + 挂载设备：mount 分区位置 挂载位置（mount /dev/sdb1 /mnt/usbhd1）
   + 读取内存信息并转储到移动硬盘上：
     + dd if=/dev/sdb1 of=/mnt/sdcard/data bs=1024(块大小，单位是byte) count=1024（块数）
     + 用nc将信息输出到另外一台pc，nc建立监听：
       + nc -l（启动监听） -p （指定监听端口） 10015（指定的端口） > collect.mem.img (接受数据的文件) &（后台运行）
       + 参考[Linux 中的 &](https://linux.cn/article-10587-1.html?pr) 、[linux - netcat网络工具-nc](https://baijiahao.baidu.com/s?id=1645748755772816935&wfr=spider&for=pc)

3. **进程信息**

   + who命令：查看当前登录的用户情况。
   + w命令：该命令也用于显示登录到系统的用户情况,但是与who不同的是,w命令功能更加强大,它不但可以显示哪些用户登录到系统,还可以显示出这些用户当前正在进行的工作,w命令是who命令的—个增强版。
   + ps命令：进程查看命令，可以查看正在运行的进程及运行的状态、进程是否结束、进程有没有僵死、哪些进程占用了过多的资源等。ps 命令还可以监控后
     台进程的工作情况,因为后台进程是不和屏幕键盘这些标准输人/输出设备进行通信的,如果需要检测其情况,可以使用ps命令。
   + top命令：和ps命令的基本作用是相同的,显示系统当前的进程及其状态,但是top命令是一个动态显示过程,可以通过用户按键来不断刷新当前状态。如果在前台执行top命令，它将独占前台，直到用户终止该程序为止
   + 参考：[w和who命令详解](https://blog.csdn.net/lsbhjshyn/article/details/18401279)、[ps与top命令](https://www.cnblogs.com/yinfutao/p/10622371.html)

4. **网络连接**

   netstat

   + -a: 显示所有Socket，包括正在监听的
   + -c:  每隔1秒就重新显示一遍，直到用户中断它
   + -i: 显示所有网络接口的信息，格式同"ipconfig -e”
   + -n: 以网络IP地址代替名称，显示出网络连接情况
   + -r: 显示核心路由表。格式同"route -e”"
   + -t: 显示TCP协议的连接情况
   + -u: 显示UDP协议的连接情况
   + -v: 显示正在进行的工作

#### 2. Unix/Linux 电子证据分析

1. 数据预处理

   + 数据备份和分类，尝试对硬盘数据进行部分恢复

2. 日志文件

   + 系统日志：/etc/syslog.conf （缺乏认证模式，易被篡改）

   <img src="/Users/rgmax/Desktop/取证上分/9.jpg" alt="9" style="zoom:50%;" />

   + 子系统日志（连接时间日志、进程统计日志、错误日志）

   <img src="/Users/rgmax/Desktop/取证上分/10.jpg" alt="10" style="zoom:50%;" />

   + 查看日志文件的命令

   <img src="/Users/rgmax/Desktop/取证上分/11.jpg" alt="11" style="zoom:50%;" />

   + 进程统计（lastcomm命令监测系统中任何时候执行的命令）
   + 程序日志与其他（su命令日志sulog、http服务端Apache日志acces_log、error_log）

3. 其他信息源

   + 账号信息（/etc/passwd）
   + 时间调度程序（crontab命令用于在一定时间间隔调度一些命令的执行，/etc/crontab，crontab -l 显示用户的crontab文件内容，注意其中的run-parts）
   + 内核转储文件（用file命令显示内存转储文件来源及原因）
   + /tmp（临时目录，是整个系统的缓冲区，会周期性自动清除）
   + 隐藏文件和目录（.folder 以点开头的文件是隐藏的）
   + Shell（bash的历史文件 .bash_history）
   + 信任关系（/etc/hosts.equiv 、 rhosts文件）
   + 非法文件（目录中的可疑文件）

#### 3. Unix/Linux取证与分析工具

+ TCT
+ Sleuthkit （TASK）
+ Autopsy
+ SMART

### Chapter 6: 网络取证

#### 1. 网络取证 定义、目的

+ def：指针对涉及民事、刑事、管理事件而进行的对网络数据流的研究

+ 目的：保护用户和资源，防范由于持续膨胀的网络连接而产生的被非法利用、入侵以及其他犯罪行为
+ 网络数据流def：主机之间通过有线或无线方式进行的计算机网络通信
+ 对于网络取证，目前研究更强调 **对网络的动态信息收集** 和 **网络安全的主动防御**

#### 2. 网络取证的 特点（4点）

1. 主要研究对象与 **数据报、网络数据流** 有关，不局限于计算机
2. **动态取证**，满足证据的 实时性、连续性，可以重建入侵过程
3. 可**分布式取证**，以满足证据的 完整性，需部署多个取证点or取证代理，且各取证点彼此相关联动
4. 需与 **网络监控 相结合**

#### 3. 黑客攻击的一般步骤（7步）

1. 信息收集
2. 踩点
3. 查点
4. 探测弱点
5. 突破
6. 创建后门
7. 清除

#### 4. 网络取证的重点环节（5个）

1. 周界网络（本地网的防火墙以外，与外部公网相连的所有设备及连接）
2. 端到端（攻击机-受害机 的连接）
3. 日志相关（日志文件中 日期时间、来源、目的、协议）
4. 环境数据（删除后仍然存在，以及存在于 交换文件 和 slack空间 的数据）
5. 攻击现场（重现攻击过程，组织攻击逻辑顺序）

#### 5. 两类 专用网络取证

+ 与公网完全隔离的专用网络（具有物理边界，eg：公安网、军网、铁路网、特殊单位内网）【取证较为简单】
+ 虚拟专用网络-VPN（在公网上建立专用的网络）【取证稍微复杂，设计隧道技术】加密技术、认证技术等】

#### 6. 网络取证数据源

1. 防火墙和路由器（时间日期、源+目的地IP、传输层协议（TCP、UDP、ICMP）、基本协议信息（端口号之类的）、NAT映射表）
2. 数据包嗅探器和协议分析器（wireshark工具）
3. 入侵检测系统-IDS（监视特定系统的现象和事件，仅监视与自身有关的网络通信）

